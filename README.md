# My Search Api

조회 api 연습 프로젝트 (다른 계정에서 개발하다가 이 계정으로 변경)

## 상세정보

### 버전

- Java: 17
- Spring Boot : 2.7.0
- DB: H2

### 사용법

프로젝트 Clone 후 MySearchApiApplication 실행
- Edit Configurations 에서 Active profiles 를 local 로 설정 후 실행
- http 테스트는 어플리케이션 실행 후 GetApiTest.http 실행 
  
## 기능

### 장소 검색 API

Kakao, Naver API 를 사용해 검색 결과를 출력한다.
- Kakao, Naver 에서 공통으로 조회되는 단어를 우선으로 출력한다.
- Kakao, Naver 둘중 하나만 존재하는 키워드는 Kakao 를 우선순위로 정렬한다.
- 응답 결과
```json
{
"places": [
"카카오판교오피스",
"카카오스페이스닷원",
"카카오스페이스닷투",
"카카오프렌즈판교점",
"카카오뱅크",
"카카오멜론",
"카카오한남오피스",
"카카오톡대화내용복구",
"카카오고객센터"
]
}
```

### 검색 키워드 목록 API

많이 검색한 순서대로 최대 10개의 검색 키워드 목록을 제공한다.
- 응답 결과
```json
[
  {
    "keyword": "분당 삼겹살",
    "count": 3
  },
  {
    "keyword": "인덕원 곱창",
    "count": 3
  },
  {
    "keyword": "인덕원 짜장면",
    "count": 3
  },
  {
    "keyword": "카카오",
    "count": 3
  }
]
```

## 적용하고 싶은 기술적 요구사항


### 동시성 이슈 처리

- 검색어를 저장할 때 동시성 처리 코드를 추가함
- 락을 적용하여 동시에 같은 검색 데이터에 접근해서 횟수 업데이트 하는 일을 방지함.  
  (검색어 횟수 변경 유실을 방지)
- 락 점유를 위해 일정 시간만 대기하는 코드 추가

### 검색 API 장애 발생 고려

- 검색 API 제공자의 장애 발생시 서킷브레이커가 동작함
- 검색 API 장애가 서버의 문제로 전파되지 않도록 방지함

### 새 검색 API 제공자 추가시 변경 영역 최소화

- 기존 코드를 수정하는 일 없이, 새로운 코드만 추가하면 되는 구조로 만드려고 시도함

### 지속적 유지 보수 및 확장에 용이한 설계

- 테스트 코드를 작성하여 미래의 발생할 추가 또는 변경 요구사항에 좀 더 쉽게 대응할 수 있음
- CollectLogging 어노테이션을 만들어 특정 포맷의 api 로그를 남길 수 있게함  
  (로그를 남겨 추후 로깅시스템에 저장할 수 있음)

### 아직 적용하지 못한 목록

- 인수테스트 작성시 외부 api 연동 부분을 WireMockServer 로 대체하려 했으나 시간 부족으로 미적용.
- 레디스를 캐시 저장소로 활용하면 API 응답 시간 단축할 수 있고,  
  외부 저장소에 문제가 생겨도 캐시에 저장되어 있는 데이터는 반환할 수 있다  
  (레디스를 캐시로 사용한다면 데이터 동기화를 위해 비동기큐의 사용도 고려해야 할 수도 있음)
- 아키텍처 설계
  - DB 이중화 : Replication 을 통해 부하 분산 및 서비스 안정성을 높일 수 있다
  - 웹서버 또는 API Gateway 를 통한 로드밸런싱
  - 컨테이너 기술을 통해 확장성, 가용성 확보  
    - 어플리케이션을 이미지로 빌드 후 컨테이너 수를 조절하면 확장성 및 가용성 확보 가능
  
